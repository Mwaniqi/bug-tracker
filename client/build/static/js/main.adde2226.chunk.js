(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{215:function(e,t,a){e.exports=a(373)},220:function(e,t,a){},373:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(54),s=a.n(c),o=(a(220),a(22)),l=a.n(o),i=a(30),u=a(16),m=a(25),d=a(19),p=a(391),h=a(375),b=Object(n.createContext)(),E=function(e){var t=Object(n.useState)(null),a=Object(u.a)(t,2),c=a[0],s=a[1];return r.a.createElement(b.Provider,{value:[c,s]},e.children)};var g=Object(d.f)((function(e){var t=Object(n.useContext)(b),a=Object(u.a)(t,2),c=a[0],s=a[1],o=JSON.parse(sessionStorage.getItem("token")),d=function(){var t=Object(i.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://bugs-trac.herokuapp.com/users/logout",{headers:{Authorization:o}});case 2:200===t.sent.status&&(sessionStorage.removeItem("token"),s(null),e.history.push("/"));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("nav",null,r.a.createElement(p.a,{size:"small",inverted:!0,secondary:!0},r.a.createElement(p.a.Item,{as:"h3",className:"brand"},r.a.createElement(m.b,{to:"/"},"Bug Tracker")),r.a.createElement(p.a,{floated:"right",inverted:!0,secondary:!0},c?r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a.Item,null,"welcome ",c),r.a.createElement(p.a.Item,{name:"logout",onClick:d})):r.a.createElement(p.a.Item,null,r.a.createElement(m.b,{to:"/register"},r.a.createElement(h.a,{inverted:!0,compact:!0,size:"small"},"Register")),r.a.createElement(m.b,{to:"/login"},r.a.createElement(h.a,{inverted:!0,compact:!0,size:"small"},"login"))))))})),f=a(392),v=Object(n.createContext)(),j=function(e){var t=Object(n.useState)([]),a=Object(u.a)(t,2),c=a[0],s=a[1],o=Object(n.useState)(null),m=Object(u.a)(o,2),d=m[0],p=m[1];Object(n.useEffect)((function(){h(),p(!0)}),[]);var h=function(){var e=Object(i.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bugs-trac.herokuapp.com");case 2:return t=e.sent,e.next=5,t.json();case 5:if(a=e.sent,200===t.status){e.next=8;break}throw a.message;case 8:s(a),p(null);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(v.Provider,{value:[c,s,d]},e.children)},O=a(395),w=a(389),y=a(383),C=a(393),k=a(388);var x=function(){var e=Object(n.useContext)(b),t=Object(u.a)(e,1)[0],a=Object(n.useContext)(v),c=Object(u.a)(a,3),s=c[0],o=c[1],d=c[2],p=function(){var e=Object(i.a)(l.a.mark((function e(t){var a,n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.persist(),a=JSON.parse(sessionStorage.getItem("token")),n=t.target.closest(".item").id,e.next=5,fetch("https://bugs-trac.herokuapp.com/delete/"+n,{method:"delete",headers:{"Content-Type":"application/json",Authorization:a}});case 5:return r=e.sent,e.next=8,r.json();case 8:c=e.sent,403===r.status&&console.log(c),200===r.status&&o(s.filter((function(e){return e._id!==n}))),console.log(c);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(f.a.Column,{as:"section",width:9},r.a.createElement(O.a.Group,{as:w.a,className:"pad b-shadow",divided:!0,relaxed:!0,animation:"fade down",duration:300},d?r.a.createElement(y.a,{inline:"centered",size:"small"}):s.length<1?r.a.createElement(C.a,{as:"h3",textAlign:"center"},"No bugs"):s.map((function(e){return r.a.createElement(w.a.Item,{as:"article",key:e._id,id:e._id},r.a.createElement(w.a.Content,{as:"small"},r.a.createElement("strong",null,"id: ",s.indexOf(e)+1)),r.a.createElement(w.a.Content,{as:"p"},r.a.createElement("strong",null,e.summary)),r.a.createElement(w.a.Content,{as:"p"},e.description),r.a.createElement(w.a.Content,{floated:"right"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{basic:!0,compact:!0,className:"mini",color:"teal",content:"Close"}),r.a.createElement(h.a,{basic:!0,compact:!0,className:"mini",negative:!0,content:"Del",onClick:p})):r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{size:"tiny",on:"click",trigger:r.a.createElement(h.a,{basic:!0,compact:!0,className:"mini",color:"teal",content:"Close"}),content:r.a.createElement(m.b,{to:"/login"},"login"),position:"bottom center"}),r.a.createElement(k.a,{size:"tiny",on:"click",trigger:r.a.createElement(h.a,{basic:!0,compact:!0,className:"mini",negative:!0,color:"red",content:"Del"}),content:r.a.createElement(m.b,{to:"/login"},"login"),position:"bottom center"}))))}))))},N=a(206),S=a(49),B=a(134);function I(e){var t=Object(n.useState)(e),a=Object(u.a)(t,2),c=a[0],s=a[1],o=Object(n.useState)({}),l=Object(u.a)(o,2),i=l[0],m=l[1],d=r.a.useState(!1),p=Object(u.a)(d,2),h=p[0],b=(p[1],function(e){var t=Object.keys(e);for(t in e)e[t]||(console.log("".concat(t," required")),i[t]="".concat(t," required"));return i});return{values:c,setValues:s,submitting:h,handleChange:function(e){i[e.target.name]&&delete i[e.target.name],s(Object(B.a)(Object(B.a)({},c),{},Object(S.a)({},e.target.name,e.target.value)))},handleBlur:function(){var e=b(c);m(e)},errors:i,setErrors:m,validate:b}}var A=a(390),F=a(387),J=a(384),z=a(385);var P=function(){var e=Object(n.useContext)(b),t=Object(u.a)(e,1)[0],a=Object(n.useContext)(v),c=Object(u.a)(a,2),s=(c[0],c[1]),o=Object(n.useState)(null),d=Object(u.a)(o,2),p=d[0],E=d[1],g={summary:"",description:""},j=I(g),O=j.handleChange,w=j.handleBlur,y=j.values,C=j.setValues,k=j.errors,x=j.setErrors,S=j.submitting,B=j.validate,P=function(){var e=Object(i.a)(l.a.mark((function e(t){var a,n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=B(y),x(a),n=JSON.parse(sessionStorage.getItem("token")),e.next=6,fetch("https://bugs-trac.herokuapp.com/new",{method:"post",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify(y)});case 6:return r=e.sent,e.next=9,r.json();case 9:c=e.sent,200===r.status&&(E(null),s((function(e){return[].concat(Object(N.a)(e),[c])})),C(g)),422===r.status&&E("Check required fields");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(f.a.Column,{as:"section",centered:"true",width:7},r.a.createElement("div",{className:"b-shadow pad"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Add a bug"),p&&r.a.createElement(A.a,{visible:!0,error:!0,relaxed:"true",content:p}),r.a.createElement(F.a,{onSubmit:P},r.a.createElement(F.a.Field,{value:y.summary||"",label:"Summary",placeholder:"Issue summary",name:"summary",control:J.a,onChange:O,onBlur:w,className:k.summary&&"error"}),r.a.createElement(F.a.TextArea,{value:y.description||"",label:"Description",placeholder:"Issue description...",name:"description",control:z.a,rows:"6",onChange:O,onBlur:w,className:k.description&&"error"}),r.a.createElement(h.a,{disabled:S,compact:!0,color:"blue",content:"Add"}))):r.a.createElement("p",null,r.a.createElement(m.b,{to:"/login"},r.a.createElement(h.a,{compact:!0,className:"small",color:"blue",content:"New bug"})))))};var D=function(){return r.a.createElement(f.a,{padded:!0,stackable:!0,centered:!0},r.a.createElement(f.a.Row,null,r.a.createElement(j,null,r.a.createElement(P,null),r.a.createElement(x,null))))},T=a(386);var R=Object(d.f)((function(e){var t={username:"",password:"",confirmPassword:""},a=I(t),c=a.handleChange,s=a.handleBlur,o=a.values,d=a.setValues,p=a.validate,E=a.errors,g=a.setErrors,v=Object(n.useState)({}),j=Object(u.a)(v,2),O=j[0],w=j[1],y=Object(n.useContext)(b),k=Object(u.a)(y,2),x=(k[0],k[1]),N=function(){var a=Object(i.a)(l.a.mark((function a(n){var r,c,s;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),r=p(o),g(r),a.next=5,fetch("https://bugs-trac.herokuapp.com/users/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 5:return c=a.sent,a.next=8,c.json();case 8:s=a.sent;try{500===c.status?w(Object(S.a)({},"err",s.errmsg)):200!==c.status?w("fail"):(console.log(s),x(s.username),sessionStorage.setItem("token",JSON.stringify(s.token)),d(t),w({}),e.history.push("/"))}catch(l){console.log(l)}case 10:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement(f.a,{padded:!0,centered:!0},r.a.createElement(f.a.Column,{as:"section",className:"form-width"},r.a.createElement("div",{className:"b-shadow pad"},"fail"===O&&r.a.createElement(A.a,{visible:!0,error:!0,content:"Registration failed!"}),O.err&&r.a.createElement(A.a,{visible:!0,error:!0,content:O.err}),r.a.createElement(C.a,{as:"h3",textAlign:"center",block:!0},"Register"),r.a.createElement(F.a,{onSubmit:N},r.a.createElement(F.a.Field,{value:o.username||"",label:"Username",placeholder:"username",name:"username",control:J.a,onChange:c,onBlur:s,className:E.username&&"error"}),r.a.createElement(F.a.Field,{value:o.password||"",label:"Password",placeholder:"password...",name:"password",type:"password",control:J.a,onChange:c,onBlur:s,className:E.password&&"error"}),r.a.createElement(F.a.Field,{value:o.confirmPassword||"",label:"Confirm password",placeholder:"confirm password...",name:"confirmPassword",type:"password",control:J.a,onChange:c,onBlur:s,className:E.confirmPassword&&"error"}),r.a.createElement(h.a,{fluid:!0,color:"blue",content:"register"})),r.a.createElement(T.a,null),r.a.createElement("p",null,"Already registered? ",r.a.createElement(m.b,{to:"/login"},"login")))))}));var V=Object(d.f)((function(e){var t=Object(n.useContext)(b),a=Object(u.a)(t,2),c=(a[0],a[1]),s={username:"",password:""},o=I(s),d=o.handleChange,p=o.handleBlur,E=o.values,g=o.setValues,v=o.validate,j=o.errors,O=o.setErrors,w=Object(n.useState)({}),y=Object(u.a)(w,2),k=y[0],x=y[1],N=function(){var t=Object(i.a)(l.a.mark((function t(a){var n,r,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=v(E),O(n),t.next=5,fetch("https://bugs-trac.herokuapp.com/users/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});case 5:return r=t.sent,t.next=8,r.json();case 8:o=t.sent;try{404===r.status||401===r.status?x(Object(S.a)({},"err",o.errmsg)):200!==r.status?x("fail"):(c(o.username),sessionStorage.setItem("token",JSON.stringify(o.token)),g(s),x({}),e.history.push("/"))}catch(l){console.log(l)}case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(f.a,{padded:!0,centered:!0},r.a.createElement(f.a.Column,{as:"section",className:"form-width"},r.a.createElement("div",{className:"b-shadow pad"},"fail"===k&&r.a.createElement(A.a,{visible:!0,error:!0,content:"Login failed!"}),k.err&&r.a.createElement(A.a,{visible:!0,error:!0,content:k.err}),r.a.createElement(C.a,{as:"h3",textAlign:"center",block:!0},"Login"),r.a.createElement(F.a,{onSubmit:N},r.a.createElement(F.a.Field,{value:E.username||"",label:"Username",placeholder:"username",name:"username",control:J.a,onChange:d,onBlur:p,className:j.username&&"error"}),r.a.createElement(F.a.Field,{value:E.password||"",label:"Password",placeholder:"password...",name:"password",type:"password",control:J.a,onChange:d,onBlur:p,className:j.password&&"error"}),r.a.createElement(h.a,{fluid:!0,color:"blue",content:"login"})),r.a.createElement(T.a,null),r.a.createElement("p",null,"Not registered? ",r.a.createElement(m.b,{to:"/register"},"register")))))}));var q=function(){return r.a.createElement(m.a,null,r.a.createElement(E,null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(g,null)),r.a.createElement("main",{className:"main-container"},r.a.createElement(d.c,null,r.a.createElement(d.a,{exact:!0,path:"/"},r.a.createElement(D,null)),r.a.createElement(d.a,{path:"/register"},r.a.createElement(R,null)),r.a.createElement(d.a,{path:"/login"},r.a.createElement(V,null)),r.a.createElement(d.a,{path:"*",component:function(){return"404 Not Found"}}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[215,1,2]]]);
//# sourceMappingURL=main.adde2226.chunk.js.map